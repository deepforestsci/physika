# ==========================
# Differentiable conditional
# ==========================

def f(x: ℝ): ℝ:
    if x > 0.0:
        return x * x
    else:
        return 0.0 - x

# positive bracnh
a : ℝ = 3.0
f(a)
grad(f(a), a)

# negative branch
b : ℝ = - 2.0
f(b)
grad(f(b), b)
